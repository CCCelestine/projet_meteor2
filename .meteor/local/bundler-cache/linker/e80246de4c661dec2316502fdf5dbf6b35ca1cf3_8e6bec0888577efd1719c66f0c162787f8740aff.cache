[{"type":"js","data":"/* Imports for global scope */\n\nMongo = Package.mongo.Mongo;\nReactiveVar = Package['reactive-var'].ReactiveVar;\nTracker = Package.tracker.Tracker;\nDeps = Package.tracker.Deps;\nRouter = Package['iron:router'].Router;\nRouteController = Package['iron:router'].RouteController;\nAccounts = Package['accounts-base'].Accounts;\nAutoForm = Package['aldeed:autoform'].AutoForm;\nCollection2 = Package['aldeed:collection2'].Collection2;\n$ = Package.jquery.$;\njQuery = Package.jquery.jQuery;\n_ = Package.underscore._;\nRoles = Package['alanning:roles'].Roles;\nMeteor = Package.meteor.Meteor;\nglobal = Package.meteor.global;\nmeteorEnv = Package.meteor.meteorEnv;\nWebApp = Package.webapp.WebApp;\nDDP = Package['ddp-client'].DDP;\nLaunchScreen = Package['launch-screen'].LaunchScreen;\nBlaze = Package.ui.Blaze;\nUI = Package.ui.UI;\nHandlebars = Package.ui.Handlebars;\nSpacebars = Package.spacebars.Spacebars;\nTemplate = Package['templating-runtime'].Template;\nmeteorInstall = Package.modules.meteorInstall;\nmeteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nPromise = Package.promise.Promise;\nIron = Package['iron:core'].Iron;\nAutoupdate = Package.autoupdate.Autoupdate;\nReload = Package.reload.Reload;\nHTML = Package.htmljs.HTML;\nSymbol = Package['ecmascript-runtime-client'].Symbol;\nMap = Package['ecmascript-runtime-client'].Map;\nSet = Package['ecmascript-runtime-client'].Set;\n\n","servePath":"/global-imports.js"},{"type":"js","data":"var require = meteorInstall({\"client\":{\"views\":{\"app\":{\"template.accueil.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/app/template.accueil.js                                                                           //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"accueil\");\nTemplate[\"accueil\"] = new Template(\"Template.accueil\", (function() {\n  var view = this;\n  return [ Blaze.View(\"lookup:setTitle\", function() {\n    return Spacebars.mustache(view.lookup(\"setTitle\"), \"Accueil\");\n  }), HTML.Raw(\"\\n\\n    <h2>Accueil</h2>\\n\\n    <header>\\n        <h3>Liste de commerces</h3>\\n    </header>\\n\\n    \"), HTML.UL(\"\\n        \", Blaze.Each(function() {\n    return Spacebars.call(view.lookup(\"commerces\"));\n  }, function() {\n    return [ \"\\n            \", HTML.LI(HTML.A({\n      href: function() {\n        return [ \"/commerces/\", Spacebars.mustache(view.lookup(\"_id\")) ];\n      }\n    }, \" \", Blaze.View(\"lookup:name\", function() {\n      return Spacebars.mustache(view.lookup(\"name\"));\n    }), \" \")), \"\\n        \" ];\n  }), \"\\n    \") ];\n}));\n\nTemplate.__checkName(\"commerce\");\nTemplate[\"commerce\"] = new Template(\"Template.commerce\", (function() {\n  var view = this;\n  return HTML.LI(Blaze.View(\"lookup:text\", function() {\n    return Spacebars.mustache(view.lookup(\"text\"));\n  }));\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.ajoutCommerce.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/app/template.ajoutCommerce.js                                                                     //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"ajoutCommerce\");\nTemplate[\"ajoutCommerce\"] = new Template(\"Template.ajoutCommerce\", (function() {\n  var view = this;\n  return [ HTML.Raw('<h1 class=\"text-center\">Ajouter un commerce</h1>\\n    '), Blaze._TemplateWith(function() {\n    return {\n      collection: Spacebars.call(\"Commerces\"),\n      id: Spacebars.call(\"ajoutCommerce\")\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"autoForm\"), function() {\n      return [ \"\\n        \", HTML.FIELDSET(\"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"name\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"horaire\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"telephone\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"ville\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"adresse\"),\n          rows: Spacebars.call(2)\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n        \"), \"\\n        \", HTML.BUTTON({\n        type: \"submit\",\n        class: \"btn btn-primary\"\n      }, \"Valider\"), \"\\n    \" ];\n    });\n  }) ];\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.ajoutMenu.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/app/template.ajoutMenu.js                                                                         //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"ajoutMenu\");\nTemplate[\"ajoutMenu\"] = new Template(\"Template.ajoutMenu\", (function() {\n  var view = this;\n  return [ HTML.Raw('<h1 class=\"text-center\">Ajouter un menu</h1>\\n    '), Blaze._TemplateWith(function() {\n    return {\n      collection: Spacebars.call(\"Menus\"),\n      id: Spacebars.call(\"ajoutMenu\")\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"autoForm\"), function() {\n      return [ \"\\n        \", HTML.FIELDSET(\"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"commerces\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"name\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"description\"),\n          rows: Spacebars.call(5)\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"prix\"),\n          placeholder: Spacebars.call(\" €\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"rest\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"photo\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n        \"), \"\\n        \", HTML.BUTTON({\n        type: \"submit\",\n        class: \"btn btn-primary\"\n      }, \"Valider\"), \"\\n    \" ];\n    });\n  }) ];\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.commerces.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/app/template.commerces.js                                                                         //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"commerces\");\nTemplate[\"commerces\"] = new Template(\"Template.commerces\", (function() {\n  var view = this;\n  return HTML.H2(Blaze.View(\"lookup:name\", function() {\n    return Spacebars.mustache(view.lookup(\"name\"));\n  }));\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.loggedInHome.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/app/template.loggedInHome.js                                                                      //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"loggedInHome\");\nTemplate[\"loggedInHome\"] = new Template(\"Template.loggedInHome\", (function() {\n  var view = this;\n  return [ HTML.H2(\"Bienvenue \", Blaze.View(\"lookup:currentUser.username\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"currentUser\"), \"username\"));\n  }), \" !\"), \"\\n    \", Blaze.View(\"lookup:setTitle\", function() {\n    return Spacebars.mustache(view.lookup(\"setTitle\"), \"Bienvenue\");\n  }) ];\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"ajoutCommerce.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/app/ajoutCommerce.js                                                                              //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n/*\nTemplate.ajoutCommerce.events({\n    'submit form': function(e){\n        e.preventDefault();\n\n        var name = $(\"input[name='name']\").val();\n        var horaire = $(\"input[name='horaire']\").val();\n        var telephone = $(\"input[name='telephone']\").val();\n        var ville = $(\"input[name='ville']\").val();\n        var adresse = $(\"textarea[name='adresse']\").val();\n\n\n        var commerce = {\n            name: name,\n            horaire: horaire,\n            telephone: telephone,\n            ville: ville,\n            adresse: adresse,\n        }\nconsole.log(commerce);\n        Commerces.insert(commerce);\n    }\n});\n*/\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"ajoutMenu.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/app/ajoutMenu.js                                                                                  //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nTemplate.ajoutMenu.events({\n  'submit form': function (e) {\n    e.preventDefault();\n    var commerces = $(\"input[commerces='commerces']\").val();\n    var name = $(\"input[name='name']\").val();\n    var description = $(\"input[description='description']\").val();\n    var prix = $(\"input[prix='prix']\").val();\n    var rest = $(\"input[rest='rest']\").val();\n    var photo = $(\"input[photo='photo']\").val();\n    var menu = {\n      commerces: commerces,\n      name: name,\n      description: description,\n      prix: prix,\n      rest: rest,\n      photo: photo\n    };\n    Menus.insert(menu);\n  }\n});\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"base\":{\"template.layout.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/base/template.layout.js                                                                           //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"mainLayout\");\nTemplate[\"mainLayout\"] = new Template(\"Template.mainLayout\", (function() {\n  var view = this;\n  return [ HTML.HEAD(\"\\n        \", HTML.TITLE(\"GFaim\"), \"\\n        \", HTML.Raw('<meta charset=\"utf-8\">'), \"\\n    \"), \"\\n    \", HTML.BODY(\"\\n    \", Blaze.View(\"lookup:setTitle\", function() {\n    return Spacebars.mustache(view.lookup(\"setTitle\"));\n  }), \"\\n\\n\\n\\n    \", HTML.DIV({\n    class: \"container\"\n  }, \"\\n        \", HTML.DIV({\n    class: \"row\"\n  }, \"\\n            \", HTML.HEADER({\n    class: \"col-md-12 jumbotron\"\n  }, \"\\n                \", HTML.H1(\"\\n                    \", Blaze.View(\"lookup:getGlobal\", function() {\n    return Spacebars.mustache(view.lookup(\"getGlobal\"), \"appName\");\n  }), \" \", HTML.Raw(\"<br>\"), \"\\n                    \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"getGlobal\"), \"appSlogan\");\n  }, function() {\n    return [ \"\\n                    \", HTML.SMALL({\n      class: \"slogan\"\n    }, Blaze.View(\"lookup:getGlobal\", function() {\n      return Spacebars.mustache(view.lookup(\"getGlobal\"), \"appSlogan\");\n    })), \"\\n                    \" ];\n  }), \"\\n\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row\"\n  }, \"\\n            \", HTML.NAV({\n    class: \"col-md-3\"\n  }, Spacebars.include(view.lookupTemplate(\"menu\"))), \"\\n            \", HTML.SECTION({\n    class: \"col-md-9 well\"\n  }, Spacebars.include(view.lookupTemplate(\"yield\"))), \"\\n        \"), \"\\n        \", HTML.Raw('<div class=\"row\">\\n            <footer class=\"col-md-12\">\\n                <hr>\\n                <div class=\"footer\">\\n                    <p>Réalisé par Célestine Chareyre</p>\\n                </div>\\n            </footer>\\n        </div>'), \"\\n    \"), \"\\n    \") ];\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.menu.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/base/template.menu.js                                                                             //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"menu\");\nTemplate[\"menu\"] = new Template(\"Template.menu\", (function() {\n  var view = this;\n  return [ HTML.Raw(\"<h3>Menu</h3>\\n    \"), HTML.UL({\n    class: \"nav nav-pills nav-stacked\"\n  }, \"\\n        \", HTML.LI(HTML.A({\n    href: function() {\n      return Spacebars.mustache(view.lookup(\"pathFor\"), Spacebars.kw({\n        route: \"accueil\"\n      }));\n    }\n  }, \"Accueil\")), \"\\n    \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"currentUser\"));\n  }, function() {\n    return \" \";\n  }, function() {\n    return [ \" \", HTML.LI(HTML.A({\n      href: function() {\n        return Spacebars.mustache(view.lookup(\"pathFor\"), Spacebars.kw({\n          route: \"user.register\"\n        }));\n      }\n    }, \"S'inscrire\")), \" \" ];\n  }), \"\\n        \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"isAdmin\"));\n  }, function() {\n    return [ \"\\n            \", HTML.LI(\" \", HTML.A({\n      href: function() {\n        return Spacebars.mustache(view.lookup(\"pathFor\"), Spacebars.kw({\n          route: \"ajoutCommerce\"\n        }));\n      }\n    }, \" Ajouter un commerce \")), \"\\n            \", HTML.LI(\" \", HTML.A({\n      href: function() {\n        return Spacebars.mustache(view.lookup(\"pathFor\"), Spacebars.kw({\n          route: \"ajoutMenu\"\n        }));\n      }\n    }, \" Ajouter un menu \")), \"\\n        \" ];\n  }), \"\\n    \"), HTML.Raw(\"\\n\\n\\n    <h3>Mon compte</h3>\\n    \"), HTML.UL({\n    class: \"nav nav-pills nav-stacked\"\n  }, \"\\n\\n        \", HTML.Raw(\"<!-- Affiche le nom de l'user et un bouton de deconnexion quand l'user est connecté, sinon affiche un bouton de connexion -->\"), \"\\n        \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"currentUser\"));\n  }, function() {\n    return [ \"\\n            \", HTML.LI(\" \", Spacebars.include(view.lookupTemplate(\"dashboard\"))), \"\\n        \" ];\n  }, function() {\n    return [ \"\\n                \", HTML.A({\n      href: function() {\n        return Spacebars.mustache(view.lookup(\"pathFor\"), Spacebars.kw({\n          route: \"user.login\"\n        }));\n      }\n    }, \"Connectez-vous !\"), \"\\n        \" ];\n  }), \"\\n    \") ];\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"users\":{\"template.dashboard.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/users/template.dashboard.js                                                                       //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"dashboard\");\nTemplate[\"dashboard\"] = new Template(\"Template.dashboard\", (function() {\n  var view = this;\n  return HTML.UL({\n    class: \"nav nav-pills nav-stacked\"\n  }, \"\\n    \", HTML.LI(\" \", Blaze.View(\"lookup:currentUser.username\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"currentUser\"), \"username\"));\n  }), \" \"), HTML.Raw('\\n    <li><a href=\"#\" class=\"logout\">Se déconnecter</a></li>\\n    '));\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.login.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/users/template.login.js                                                                           //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"login\");\nTemplate[\"login\"] = new Template(\"Template.login\", (function() {\n  var view = this;\n  return [ HTML.Raw('<h1 class=\"text-center\">Se connecter</h1>\\n    '), HTML.FORM(\"\\n        \", HTML.Raw('<div class=\"form-group\">\\n            <label for=\"username\">Nom d\\'utilisateur ou email</label>\\n            <input id=\"username\" class=\"form-control\" type=\"text\">\\n        </div>'), \"\\n        \", HTML.Raw('<div class=\"form-group\">\\n            <label for=\"password\">Mot de passe</label>\\n            <input id=\"password\" class=\"form-control\" type=\"password\">\\n        </div>'), \"\\n        \", HTML.P(HTML.A({\n    href: function() {\n      return Spacebars.mustache(view.lookup(\"pathFor\"), Spacebars.kw({\n        route: \"user.register\"\n      }));\n    }\n  }, \"Pas encore membre ?\")), \"\\n        \", HTML.Raw('<button class=\"btn btn-primary\">Connexion</button>'), \"\\n    \") ];\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.register.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/users/template.register.js                                                                        //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n\nTemplate.__checkName(\"register\");\nTemplate[\"register\"] = new Template(\"Template.register\", (function() {\n  var view = this;\n  return [ HTML.Raw('<h1 class=\"text-center\">Enregistrement</h1>\\n    '), Blaze._TemplateWith(function() {\n    return {\n      collection: Spacebars.call(\"Meteor.users\"),\n      id: Spacebars.call(\"insertUser\")\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"autoForm\"), function() {\n      return [ \"\\n    \", HTML.FIELDSET(\"\\n        \", HTML.LEGEND(\"Informations obligatoires\"), \"\\n        \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"username\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n        \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"password\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n        \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"confirmation\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n        \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"emails\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n    \"), \"\\n    \", HTML.FIELDSET(\"\\n        \", HTML.LEGEND(\"Informations facultatives\"), \"\\n        \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"profile.firstName\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n        \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"profile.lastName\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n        \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"profile.birthDay\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n        \", Blaze._TemplateWith(function() {\n        return {\n          name: Spacebars.call(\"profile.gender\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"afQuickField\"));\n      }), \"\\n\\n    \"), \"\\n    \", HTML.BUTTON({\n        type: \"submit\",\n        class: \"btn btn-primary\"\n      }, \"Valider\"), \"\\n    \" ];\n    });\n  }) ];\n}));\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"dashboard.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/users/dashboard.js                                                                                //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nTemplate.dashboard.events({\n  'click .logout': function (event) {\n    event.preventDefault();\n    Meteor.logout();\n    Router.go(Utils.pathFor('accueil'));\n  }\n});\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"login.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/views/users/login.js                                                                                    //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nTemplate.login.events({\n  \"submit form\": function (event, template) {\n    event.preventDefault();\n    var user = $('#username').val();\n    var password = $('#password').val();\n    Meteor.loginWithPassword(user, password, function (err) {\n      if (err) {\n        alert(err.reason);\n      } else {\n        Router.go(Utils.pathFor('loggedInHome'));\n      }\n    });\n  }\n});\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"config\":{\"FormHooks\":{\"Commerces.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/config/FormHooks/Commerces.js                                                                           //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nAutoForm.hooks({\n  'ajoutCommerce': {\n    onSubmit: function (doc) {\n      // Gestion du formulaire d'inscription\n      console.log(doc);\n      var error = null;\n      var name = doc.name;\n      var horaire = doc.horaire;\n      var telephone = doc.telephone;\n      var ville = doc.ville;\n      var adresse = doc.adresse;\n      Commerces.insert({\n        name: name,\n        horaire: horaire,\n        telephone: telephone,\n        ville: ville,\n        adresse: adresse\n      }, function (err) {\n        if (err) {\n          error = new Error(\"Une erreur s'est produite\");\n        }\n      });\n\n      if (error === null) {\n        this.done(); // Appelle onSuccess\n      } else {\n        this.done(error); // Appelle onError\n      }\n\n      return false; // Dans tout les cas, arrete la soumission des donneés.\n    },\n    onSuccess: function () {\n      Router.go(Utils.pathFor('accueil'));\n    },\n    onError: function (formType, err) {\n      alert(err.reason);\n    }\n  }\n});\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"Users.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/config/FormHooks/Users.js                                                                               //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nAutoForm.hooks({\n  'insertUser': {\n    onSubmit: function (doc) {\n      // Gestion du formulaire d'inscription\n      console.log(doc);\n      var error = null;\n      var password = doc.password;\n      var email = doc.emails[0].address;\n      Accounts.createUser({\n        username: doc.username,\n        email: email,\n        password: password,\n        profile: doc.profile ? doc.profile : {}\n      }, function (err) {\n        if (err) {\n          error = new Error(\"Une erreur s'est produite\");\n        }\n      });\n\n      if (error === null) {\n        this.done(); // Appelle onSuccess\n      } else {\n        this.done(error); // Appelle onError\n      }\n\n      return false; // Dans tout les cas, arrete la soumission des donneés.\n    },\n    onSuccess: function () {\n      Router.go(Utils.pathFor('accueil'));\n    },\n    onError: function (formType, err) {\n      alert(err.reason);\n    }\n  }\n});\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"Helpers.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/config/Helpers.js                                                                                       //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nUI.registerHelper('getGlobal', function (varName) {\n  return Globals[varName];\n});\nUI.registerHelper('setTitle', function (title) {\n  if (!title) {\n    title = Globals.appName;\n  } else {\n    title += \" - \" + Globals.appName;\n  }\n\n  document.title = title;\n});\nUI.registerHelper('isAdmin', function () {\n  if (Roles.userIsInRole(Meteor.userId(), ['admin'])) {\n    return true;\n  } else return false;\n});\n/*\nTemplate.commerces.helpers({\n    'commerce': function(){\n        let _id = Iron.controller().getParams()._id;\n\n        console.log(Commerces.findOne({_id: _id}));\n       return _id;\n    }\n});*/\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"lib\":{\"Globals.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// lib/Globals.js                                                                                                 //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nGlobals = {\n  appName: \"GFaim\",\n  appSlogan: \"L'application qui comble votre faim !\",\n  // Nous stockerons également nos schémas ici\n  schemas: {}\n};\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"Utils.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// lib/Utils.js                                                                                                   //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nUtils = {\n  formatDate: function (date) {\n    var date = new Date(date);\n    var day = date.getDate().toString();\n    var month = (date.getMonth() + 1).toString();\n    var year = date.getFullYear();\n\n    if (day.length === 1) {\n      day = '0' + day;\n    }\n\n    if (month.length === 1) {\n      month = '0' + month;\n    }\n\n    return day + '/' + month + '/' + year;\n  },\n  pathFor: function (routeName, params) {\n    // Similaire au helper \"pathFor\", mais utilisable directement dans le code\n    var route = Router.routes[routeName].path(params);\n    return route;\n  }\n};\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"routeur.js\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// lib/routeur.js                                                                                                 //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nRouter.configure({\n  layoutTemplate: 'mainLayout'\n});\nRouter.route('/', {\n  name: 'accueil',\n  template: \"accueil\",\n  data: function () {\n    var commerces = Commerces.find();\n    return {\n      commerces: commerces\n    };\n  },\n  waitOn: function () {\n    return Meteor.subscribe(\"allCommerces\");\n  }\n});\nRouter.route('/register', {\n  name: \"user.register\",\n  //name: \"register\",\n  template: \"register\"\n});\nRouter.route('/login', {\n  name: \"user.login\",\n  //name: \"login\",\n  template: \"login\"\n});\nRouter.route('/loggedInHome', {\n  name: \"loggedInHome\",\n  template: \"loggedInHome\"\n});\nRouter.route('/ajoutCommerce', {\n  name: \"ajoutCommerce\",\n  template: \"ajoutCommerce\"\n});\nRouter.route('/ajoutMenu', {\n  name: \"ajoutMenu\",\n  template: \"ajoutMenu\"\n});\nRouter.route('/commerces/:_id', function () {\n  this.render('commerces', {\n    data: function () {\n      return Commerces.findOne({\n        _id: this.params._id\n      });\n    },\n    waitOn: function () {\n      return Meteor.subscribe(\"allCommerces\");\n    }\n  });\n});\n/*Router.route('/commerces', {\n    name: \"commerces\",\n    template: \"commerces\"\n});*/\n\n/*Router.route('/commerces/:_id', {\n    name: \"commerces\",\n    template: \"commerces\",\n    data: function(){\n        let commerces = Commerces.findOne(this.param._id);\n\n        return {\n            commerces: commerces\n        };\n    },\n    waitOn: function(){\n        return Meteor.subscribe(\"allPostHeaders\");\n    }\n});\n\nvar params = this.params; // { _id: \"5\" }\nvar id = params._id; // \"5\"*/\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"collections\":{\"Commerces.js\":function(require,exports,module){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// collections/Commerces.js                                                                                       //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nvar SimpleSchema;\nmodule.watch(require(\"simpl-schema\"), {\n  \"default\": function (v) {\n    SimpleSchema = v;\n  }\n}, 0);\nSimpleSchema.extendOptions(['autoform']);\nSimpleSchema.extendOptions(['denyUpdate']);\nCommerces = new Mongo.Collection('commerces');\nCommerces.allow({\n  insert: function () {\n    return true;\n  },\n  update: function () {\n    return true;\n  },\n  remove: function () {\n    return true;\n  }\n});\nCommerces.attachSchema(new SimpleSchema({\n  name: {\n    type: String,\n    label: \"Nom\"\n  },\n  horaire: {\n    type: String,\n    label: \"Horaires\"\n  },\n  telephone: {\n    type: String,\n    label: \"Téléphone\"\n  },\n  ville: {\n    type: String,\n    label: \"Ville\"\n  },\n  adresse: {\n    type: String,\n    label: \"Adresse\"\n  }\n}));\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"Menus.js\":function(require,exports,module){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// collections/Menus.js                                                                                           //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nvar SimpleSchema;\nmodule.watch(require(\"simpl-schema\"), {\n  \"default\": function (v) {\n    SimpleSchema = v;\n  }\n}, 0);\nSimpleSchema.extendOptions(['autoform']);\nSimpleSchema.extendOptions(['denyUpdate']);\nMenus = new Mongo.Collection('menus');\nMenus.allow({\n  insert: function () {\n    return true;\n  },\n  update: function () {\n    return true;\n  },\n  remove: function () {\n    return true;\n  }\n});\nMenus.attachSchema(new SimpleSchema({\n  name: {\n    type: String,\n    label: \"Nom\"\n  },\n  description: {\n    type: String,\n    label: \"Description\"\n  },\n  prix: {\n    type: Number,\n    label: \"Prix\"\n  },\n  rest: {\n    type: String,\n    label: \"Nombre de produits restants (facultatif)\",\n    optional: true\n  },\n  photo: {\n    type: String,\n    label: \"URL de l'image (facultatif)\",\n    optional: true\n  },\n  commerces: {\n    type: Array,\n    label: \"Commerces\",\n    autoform: {\n      type: \"select2\",\n      options: function () {\n        var commerces = Commerces.find().fetch(); // Tableau de commerces\n\n        console.log(commerces);\n        var optTab = [];\n\n        for (var i in meteorBabelHelpers.sanitizeForInObject(commerces)) {\n          optTab[i] = {};\n          optTab[i].label = commerces[i].name;\n          optTab[i].value = commerces[i].name;\n        }\n\n        console.log(optTab);\n        return optTab;\n      }\n    }\n  },\n  \"commerces.$\": {\n    type: String\n  }\n}));\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"Users.js\":function(require,exports,module){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// collections/Users.js                                                                                           //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nvar SimpleSchema;\nmodule.watch(require(\"simpl-schema\"), {\n  \"default\": function (v) {\n    SimpleSchema = v;\n  }\n}, 0);\nSimpleSchema.extendOptions(['autoform']);\nSimpleSchema.extendOptions(['denyUpdate']); // Schéma du profil\n\nGlobals.schemas.UserProfile = new SimpleSchema({\n  firstName: {\n    type: String,\n    regEx: /^[a-zA-Z-]{2,25}/,\n    optional: true,\n    label: \"Prénom\"\n  },\n  lastName: {\n    type: String,\n    regEx: /^[a-zA-Z-]{2,25}/,\n    optional: true,\n    label: \"Nom\"\n  },\n  birthDay: {\n    type: Date,\n    optional: true,\n    label: \"Date de naissance\"\n  },\n  gender: {\n    type: String,\n    allowedValues: ['M', 'F'],\n    optional: true,\n    label: \"Genre\",\n    autoform: {\n      afFieldInput: {\n        type: \"select2\",\n        // type de champ particulier, voir plus bas\n        options: [{\n          value: \"M\",\n          label: \"Homme\"\n        }, {\n          value: \"F\",\n          label: \"Femme\"\n        }]\n      }\n    }\n  }\n}); // Schéma principal\n\nGlobals.schemas.User = new SimpleSchema({\n  username: {\n    type: String,\n    regEx: /^[a-z0-9A-Z_]{3,15}$/,\n    label: \"Nom d'utilisateur\"\n  },\n  password: {\n    type: String,\n    label: \"Mot de passe\",\n    optional: true,\n    autoform: {\n      afFieldInput: {\n        type: \"password\"\n      }\n    }\n  },\n  confirmation: {\n    type: String,\n    label: \"Confirmation\",\n    optional: true,\n    custom: function () {\n      if (this.value !== this.field('password').value) {\n        return \"passwordMissmatch\";\n      }\n    },\n    autoform: {\n      afFieldInput: {\n        type: \"password\"\n      }\n    }\n  },\n  emails: {\n    type: Array,\n    optional: false,\n    label: \"Adresses Email\"\n  },\n  \"emails.$\": {\n    type: Object\n  },\n  \"emails.$.address\": {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email,\n\n    /*regEx :[\n    {msg: \" failed regular expression validation\"},\n    {exp: SimpleSchema.RegEx.Email, msg: \" must be a valid e-mail address\"}],*/\n    label: \"Adresse\"\n  },\n  \"emails.$.verified\": {\n    type: Boolean,\n    optional: true,\n    autoform: {\n      omit: true\n    }\n  },\n  createdAt: {\n    type: Date,\n    autoValue: function () {\n      if (this.isInsert) {\n        return new Date();\n      } else {\n        this.unset();\n      }\n    },\n    autoform: {\n      omit: true\n    }\n  },\n  profile: {\n    type: Globals.schemas.UserProfile,\n    optional: true\n  },\n  services: {\n    type: Object,\n    optional: true,\n    blackbox: true,\n    autoform: {\n      omit: true\n    }\n  },\n  roles: {\n    type: Array,\n    //optional: true,\n    autoform: {\n      omit: true\n    }\n  },\n  \"roles.$\": {\n    type: String\n  }\n}); // On attache ce schéma à la collection\n\nMeteor.users.attachSchema(Globals.schemas.User);\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\",\n    \".html\",\n    \".css\"\n  ]\n});\nrequire(\"/client/views/app/template.accueil.js\");\nrequire(\"/client/views/app/template.ajoutCommerce.js\");\nrequire(\"/client/views/app/template.ajoutMenu.js\");\nrequire(\"/client/views/app/template.commerces.js\");\nrequire(\"/client/views/app/template.loggedInHome.js\");\nrequire(\"/client/views/base/template.layout.js\");\nrequire(\"/client/views/base/template.menu.js\");\nrequire(\"/client/views/users/template.dashboard.js\");\nrequire(\"/client/views/users/template.login.js\");\nrequire(\"/client/views/users/template.register.js\");\nrequire(\"/lib/Globals.js\");\nrequire(\"/lib/Utils.js\");\nrequire(\"/lib/routeur.js\");\nrequire(\"/client/config/FormHooks/Commerces.js\");\nrequire(\"/client/config/FormHooks/Users.js\");\nrequire(\"/client/views/app/ajoutCommerce.js\");\nrequire(\"/client/views/app/ajoutMenu.js\");\nrequire(\"/client/views/users/dashboard.js\");\nrequire(\"/client/views/users/login.js\");\nrequire(\"/client/config/Helpers.js\");\nrequire(\"/collections/Commerces.js\");\nrequire(\"/collections/Menus.js\");\nrequire(\"/collections/Users.js\");","servePath":"/app.js","sourceMap":{"version":3,"sources":["client/views/app/ajoutCommerce.js","client/views/app/ajoutMenu.js","client/views/users/dashboard.js","client/views/users/login.js","client/config/FormHooks/Commerces.js","client/config/FormHooks/Users.js","client/config/Helpers.js","lib/Globals.js","lib/Utils.js","lib/routeur.js","collections/Commerces.js","collections/Menus.js","collections/Users.js"],"names":["Template","ajoutMenu","events","e","preventDefault","commerces","$","val","name","description","prix","rest","photo","menu","Menus","insert","dashboard","event","Meteor","logout","Router","go","Utils","pathFor","login","template","user","password","loginWithPassword","err","alert","reason","AutoForm","hooks","onSubmit","doc","console","log","error","horaire","telephone","ville","adresse","Commerces","Error","done","onSuccess","onError","formType","email","emails","address","Accounts","createUser","username","profile","UI","registerHelper","varName","Globals","title","appName","document","Roles","userIsInRole","userId","appSlogan","schemas","formatDate","date","Date","day","getDate","toString","month","getMonth","year","getFullYear","length","routeName","params","route","routes","path","configure","layoutTemplate","data","find","waitOn","subscribe","render","findOne","_id","SimpleSchema","module","watch","require","v","extendOptions","Mongo","Collection","allow","update","remove","attachSchema","type","String","label","Number","optional","Array","autoform","options","fetch","optTab","i","value","UserProfile","firstName","regEx","lastName","birthDay","gender","allowedValues","afFieldInput","User","confirmation","custom","field","Object","RegEx","Email","Boolean","omit","createdAt","autoValue","isInsert","unset","services","blackbox","roles","users"],"mappings":"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","file":"/app.js","sourcesContent":["/*\r\nTemplate.ajoutCommerce.events({\r\n    'submit form': function(e){\r\n        e.preventDefault();\r\n\r\n        var name = $(\"input[name='name']\").val();\r\n        var horaire = $(\"input[name='horaire']\").val();\r\n        var telephone = $(\"input[name='telephone']\").val();\r\n        var ville = $(\"input[name='ville']\").val();\r\n        var adresse = $(\"textarea[name='adresse']\").val();\r\n\r\n\r\n        var commerce = {\r\n            name: name,\r\n            horaire: horaire,\r\n            telephone: telephone,\r\n            ville: ville,\r\n            adresse: adresse,\r\n        }\r\nconsole.log(commerce);\r\n        Commerces.insert(commerce);\r\n    }\r\n});\r\n*/\r\n\r\n","Template.ajoutMenu.events({\r\n    'submit form': function(e){\r\n        e.preventDefault();\r\n\r\n        var commerces = $(\"input[commerces='commerces']\").val();\r\n        var name = $(\"input[name='name']\").val();\r\n        var description = $(\"input[description='description']\").val();\r\n        var prix = $(\"input[prix='prix']\").val();\r\n        var rest = $(\"input[rest='rest']\").val();\r\n        var photo = $(\"input[photo='photo']\").val();\r\n\r\n        var menu = {\r\n            commerces: commerces,\r\n            name: name,\r\n            description: description,\r\n            prix: prix,\r\n            rest: rest,\r\n            photo: photo\r\n        }\r\n\r\n        Menus.insert(menu);\r\n    }\r\n});\r\n\r\n","Template.dashboard.events({\r\n    'click .logout': function(event){\r\n        event.preventDefault();\r\n        Meteor.logout();\r\n        Router.go(Utils.pathFor('accueil'));\r\n    }\r\n});","Template.login.events({\r\n    \"submit form\": function(event, template) {\r\n        event.preventDefault();\r\n\r\n        var user = $('#username').val();\r\n        var password = $('#password').val();\r\n\r\n        Meteor.loginWithPassword(user, password, function(err) {\r\n            if (err) {\r\n                alert(err.reason);\r\n            } else {\r\n                Router.go(Utils.pathFor('loggedInHome'));\r\n            }\r\n        });\r\n    }\r\n});\r\n","AutoForm.hooks({\r\n    'ajoutCommerce': {\r\n        onSubmit: function(doc){ // Gestion du formulaire d'inscription\r\n            console.log(doc);\r\n            var error = null;\r\n            var name = doc.name;\r\n            var horaire = doc.horaire;\r\n            var telephone = doc.telephone;\r\n            var ville = doc.ville;\r\n            var adresse = doc.adresse;\r\n\r\n            Commerces.insert({\r\n                name: name,\r\n                horaire: horaire,\r\n                telephone: telephone,\r\n                ville: ville,\r\n                adresse: adresse\r\n            }, function(err){\r\n                if(err){\r\n                    error = new Error(\"Une erreur s'est produite\");\r\n                }\r\n            });\r\n\r\n            if(error === null){\r\n                this.done(); // Appelle onSuccess\r\n            }\r\n            else{\r\n                this.done(error); // Appelle onError\r\n            }\r\n\r\n            return false; // Dans tout les cas, arrete la soumission des donneés.\r\n        },\r\n\r\n        onSuccess: function(){\r\n            Router.go(Utils.pathFor('accueil'));\r\n        },\r\n\r\n        onError: function(formType, err){\r\n            alert(err.reason)\r\n        }\r\n\r\n    }\r\n});","AutoForm.hooks({\r\n    'insertUser': {\r\n        onSubmit: function(doc){ // Gestion du formulaire d'inscription\r\n            console.log(doc);\r\n            var error = null;\r\n            var password = doc.password;\r\n            var email = doc.emails[0].address;\r\n\r\n            Accounts.createUser({\r\n                username: doc.username,\r\n                email: email,\r\n                password: password,\r\n                profile: doc.profile ? doc.profile : {}\r\n            }, function(err){\r\n                if(err){\r\n                    error = new Error(\"Une erreur s'est produite\");\r\n                }\r\n            });\r\n\r\n            if(error === null){\r\n                this.done(); // Appelle onSuccess\r\n            }\r\n            else{\r\n                this.done(error); // Appelle onError\r\n            }\r\n\r\n            return false; // Dans tout les cas, arrete la soumission des donneés.\r\n        },\r\n\r\n        onSuccess: function(){\r\n            Router.go(Utils.pathFor('accueil'));\r\n        },\r\n\r\n        onError: function(formType, err){\r\n            alert(err.reason)\r\n        }\r\n\r\n    }\r\n});","UI.registerHelper('getGlobal', function(varName) {\r\n    return Globals[varName];\r\n});\r\n\r\nUI.registerHelper('setTitle', function(title){\r\n    if(!title){\r\n        title = Globals.appName;\r\n    }\r\n    else{\r\n        title += \" - \" + Globals.appName;\r\n    }\r\n\r\n    document.title = title;\r\n});\r\n\r\nUI.registerHelper('isAdmin', function () {\r\n    if (Roles.userIsInRole(Meteor.userId(), ['admin'])) {\r\n        return true\r\n    }\r\n    else return false;\r\n});\r\n\r\n/*\r\nTemplate.commerces.helpers({\r\n    'commerce': function(){\r\n        let _id = Iron.controller().getParams()._id;\r\n\r\n        console.log(Commerces.findOne({_id: _id}));\r\n       return _id;\r\n    }\r\n});*/\r\n","Globals = {\r\n    appName: \"GFaim\",\r\n    appSlogan: \"L'application qui comble votre faim !\",\r\n    // Nous stockerons également nos schémas ici\r\n    schemas: {}\r\n};","Utils = {\r\n    formatDate: function(date) {\r\n        var date = new Date(date);\r\n\r\n        var day = date.getDate().toString();\r\n        var month = (date.getMonth() + 1).toString();\r\n        var year = date.getFullYear();\r\n\r\n        if (day.length === 1) {\r\n            day = '0' + day;\r\n        }\r\n\r\n        if (month.length === 1) {\r\n            month = '0' + month;\r\n        }\r\n\r\n        return day + '/' + month + '/' + year;\r\n    },\r\n\r\n    pathFor: function(routeName, params){\r\n        // Similaire au helper \"pathFor\", mais utilisable directement dans le code\r\n        var route = Router.routes[routeName].path(params);\r\n        return route;\r\n    }\r\n};","Router.configure({\r\n    layoutTemplate: 'mainLayout'\r\n});\r\n\r\nRouter.route('/', {\r\n    name: 'accueil',\r\n    template: \"accueil\",\r\n    data: function(){\r\n        var commerces = Commerces.find();\r\n\r\n        return {\r\n            commerces: commerces\r\n        };\r\n    },\r\n    waitOn: function(){\r\n        return Meteor.subscribe(\"allCommerces\");\r\n    }\r\n});\r\n\r\nRouter.route('/register', {\r\n    name: \"user.register\",\r\n    //name: \"register\",\r\n    template: \"register\"\r\n});\r\n\r\nRouter.route('/login', {\r\n    name: \"user.login\",\r\n    //name: \"login\",\r\n    template: \"login\"\r\n});\r\n\r\nRouter.route('/loggedInHome', {\r\n    name: \"loggedInHome\",\r\n    template: \"loggedInHome\"\r\n});\r\n\r\nRouter.route('/ajoutCommerce', {\r\n    name: \"ajoutCommerce\",\r\n    template: \"ajoutCommerce\"\r\n});\r\n\r\nRouter.route('/ajoutMenu', {\r\n    name: \"ajoutMenu\",\r\n    template: \"ajoutMenu\"\r\n});\r\n\r\nRouter.route('/commerces/:_id', function () {\r\n    this.render('commerces', {\r\n        data: function () {\r\n            return Commerces.findOne({_id: this.params._id});\r\n        },\r\n        waitOn: function(){\r\n            return Meteor.subscribe(\"allCommerces\");\r\n        }\r\n    });\r\n});\r\n\r\n\r\n\r\n/*Router.route('/commerces', {\r\n    name: \"commerces\",\r\n    template: \"commerces\"\r\n});*/\r\n\r\n/*Router.route('/commerces/:_id', {\r\n    name: \"commerces\",\r\n    template: \"commerces\",\r\n    data: function(){\r\n        let commerces = Commerces.findOne(this.param._id);\r\n\r\n        return {\r\n            commerces: commerces\r\n        };\r\n    },\r\n    waitOn: function(){\r\n        return Meteor.subscribe(\"allPostHeaders\");\r\n    }\r\n});\r\n\r\nvar params = this.params; // { _id: \"5\" }\r\nvar id = params._id; // \"5\"*/\r\n\r\n","import SimpleSchema from 'simpl-schema';\r\nSimpleSchema.extendOptions(['autoform']);\r\nSimpleSchema.extendOptions(['denyUpdate']);\r\n\r\nCommerces = new Mongo.Collection('commerces');\r\n\r\nCommerces.allow({\r\n    insert: function(){return true;},\r\n    update: function(){return true;},\r\n    remove: function(){return true;}\r\n});\r\n\r\nCommerces.attachSchema(new SimpleSchema({\r\n    name: {\r\n        type: String,\r\n        label: \"Nom\"\r\n    },\r\n    horaire: {\r\n        type: String,\r\n        label: \"Horaires\"\r\n    },\r\n    telephone: {\r\n        type: String,\r\n        label: \"Téléphone\"\r\n    },\r\n    ville: {\r\n        type: String,\r\n        label: \"Ville\"\r\n    },\r\n    adresse: {\r\n        type: String,\r\n        label: \"Adresse\"\r\n    }\r\n\r\n}));","import SimpleSchema from 'simpl-schema';\r\nSimpleSchema.extendOptions(['autoform']);\r\nSimpleSchema.extendOptions(['denyUpdate']);\r\n\r\nMenus = new Mongo.Collection('menus');\r\n\r\nMenus.allow({\r\n    insert: function(){return true;},\r\n    update: function(){return true;},\r\n    remove: function(){return true;}\r\n});\r\n\r\nMenus.attachSchema(new SimpleSchema({\r\n    name: {\r\n        type: String,\r\n        label: \"Nom\"\r\n    },\r\n    description: {\r\n        type: String,\r\n        label: \"Description\"\r\n    },\r\n    prix: {\r\n        type: Number,\r\n        label: \"Prix\"\r\n    },\r\n    rest: {\r\n        type: String,\r\n        label: \"Nombre de produits restants (facultatif)\",\r\n        optional: true\r\n    },\r\n    photo: {\r\n        type: String,\r\n        label: \"URL de l'image (facultatif)\",\r\n        optional: true\r\n    },\r\n    commerces: {\r\n        type: Array,\r\n        label: \"Commerces\",\r\n        autoform: {\r\n            type: \"select2\",\r\n            options: function () {\r\n                var commerces = Commerces.find().fetch(); // Tableau de commerces\r\n                console.log(commerces);\r\n                var optTab = [];\r\n\r\n                for (var i in commerces) {\r\n                    optTab[i] = {};\r\n                    optTab[i].label = commerces[i].name;\r\n                    optTab[i].value = commerces[i].name;\r\n                }\r\n                console.log(optTab);\r\n                return optTab;\r\n            }\r\n        }\r\n    },\r\n    \"commerces.$\": {\r\n        type: String\r\n    }\r\n\r\n}));","import SimpleSchema from 'simpl-schema';\r\nSimpleSchema.extendOptions(['autoform']);\r\nSimpleSchema.extendOptions(['denyUpdate']);\r\n\r\n// Schéma du profil\r\nGlobals.schemas.UserProfile = new SimpleSchema({\r\n    firstName: {\r\n        type: String,\r\n        regEx: /^[a-zA-Z-]{2,25}/,\r\n        optional: true,\r\n        label: \"Prénom\"\r\n    },\r\n    lastName: {\r\n        type: String,\r\n        regEx: /^[a-zA-Z-]{2,25}/,\r\n        optional: true,\r\n        label: \"Nom\"\r\n    },\r\n    birthDay: {\r\n        type: Date,\r\n        optional: true,\r\n        label: \"Date de naissance\"\r\n    },\r\n    gender: {\r\n        type: String,\r\n        allowedValues: ['M', 'F'],\r\n        optional: true,\r\n        label: \"Genre\",\r\n        autoform: {\r\n            afFieldInput: {\r\n                type: \"select2\", // type de champ particulier, voir plus bas\r\n                options: [\r\n                    {\r\n                        value: \"M\",\r\n                        label: \"Homme\"\r\n                    },\r\n                    {\r\n                        value: \"F\",\r\n                        label: \"Femme\"\r\n                    }\r\n                ]\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n// Schéma principal\r\nGlobals.schemas.User = new SimpleSchema({\r\n    username: {\r\n        type: String,\r\n        regEx: /^[a-z0-9A-Z_]{3,15}$/,\r\n        label: \"Nom d'utilisateur\"\r\n    },\r\n    password: {\r\n        type: String,\r\n        label: \"Mot de passe\",\r\n        optional: true,\r\n        autoform: {\r\n            afFieldInput: {\r\n                type: \"password\"\r\n            }\r\n        }\r\n    },\r\n    confirmation: {\r\n        type: String,\r\n        label: \"Confirmation\",\r\n        optional: true,\r\n        custom: function(){\r\n            if(this.value !== this.field('password').value){\r\n                return \"passwordMissmatch\";\r\n            }\r\n        },\r\n        autoform: {\r\n            afFieldInput: {\r\n                type: \"password\"\r\n            }\r\n        }\r\n    },\r\n    emails: {\r\n        type: Array,\r\n        optional: false,\r\n        label: \"Adresses Email\"\r\n    },\r\n    \"emails.$\": {\r\n        type: Object,\r\n    },\r\n    \"emails.$.address\": {\r\n        type: String,\r\n        regEx: SimpleSchema.RegEx.Email,\r\n        /*regEx :[\r\n        {msg: \" failed regular expression validation\"},\r\n        {exp: SimpleSchema.RegEx.Email, msg: \" must be a valid e-mail address\"}],*/\r\n        label: \"Adresse\",\r\n    },\r\n    \"emails.$.verified\": {\r\n        type: Boolean,\r\n        optional: true,\r\n        autoform: {\r\n            omit: true\r\n        }\r\n    },\r\n    createdAt: {\r\n        type: Date,\r\n        autoValue: function () {\r\n            if (this.isInsert) {\r\n                return new Date;\r\n            } else {\r\n                this.unset();\r\n            }\r\n        },\r\n        autoform: {\r\n            omit: true\r\n        }\r\n    },\r\n    profile: {\r\n        type: Globals.schemas.UserProfile,\r\n        optional: true,\r\n\r\n    },\r\n    services: {\r\n        type: Object,\r\n        optional: true,\r\n        blackbox: true,\r\n        autoform:{\r\n            omit: true\r\n        }\r\n    },\r\n    roles: {\r\n        type: Array,\r\n        //optional: true,\r\n        autoform: {\r\n            omit: true\r\n        }\r\n    }\r\n   ,\r\n    \"roles.$\": {\r\n        type: String\r\n    }\r\n});\r\n\r\n// On attache ce schéma à la collection\r\nMeteor.users.attachSchema(Globals.schemas.User);"]}}]